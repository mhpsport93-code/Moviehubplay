<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>filesdl.live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui;background:#f2f2f2;color:#111}
header{position:sticky;top:0;background:#000;color:#fff;padding:14px 16px;font-size:18px;font-weight:800}
.container{max-width:900px;margin:auto;padding:16px}
.post-title{font-size:22px;font-weight:800;text-align:center;margin-bottom:20px}

.card{background:#fff;border-radius:14px;padding:18px;margin-bottom:18px;box-shadow:0 4px 14px rgba(0,0,0,.08)}
.card h3{text-align:center;font-size:20px;font-weight:800;margin-bottom:14px}

.btn{display:block;width:100%;padding:14px;border-radius:10px;text-align:center;font-weight:800;color:#fff;text-decoration:none;font-size:15px}
.btn + .btn{margin-top:12px}

.size{font-size:13px;font-weight:700;opacity:.9;margin-top:6px;text-align:center}

.gdflix{background:#1e824c}
.direct{background:#e67e22}
.blue{background:#1f4f6f}
.red{background:#b03a2e}
.green{background:#117864}
.gold{background:#9a7d0a}
.purple{background:#76448a}

.skeleton{height:120px;border-radius:14px;background:linear-gradient(90deg,#ddd 25%,#eee 50%,#ddd 75%);background-size:200% 100%;animation:shimmer 1.4s infinite;margin-bottom:18px}
@keyframes shimmer{to{background-position:-200% 0}}
</style>
</head>
<body>

<header id="headerTitle">filesdl.live</header>

<div class="container" id="app">
  <div class="skeleton"></div>
  <div class="skeleton"></div>
</div>

<script>
const API="https://filesdl.live/wp-json/wp/v2/posts?_embed&per_page=10";
const app=document.getElementById("app");
const headerTitle=document.getElementById("headerTitle");

function qs(k){return new URLSearchParams(location.search).get(k)}

function slugify(t){
 return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
}

function extractBlocks(html){
 const div=document.createElement("div");
 div.innerHTML=html;
 const blocks=[];
 div.querySelectorAll("h1,h2,h3").forEach(h=>{
   const text=h.textContent.trim();
   const size=text.match(/(\d+(\.\d+)?\s*(MB|GB))/i);
   const links=[];
   let el=h.nextElementSibling;
   while(el && el.tagName==="A"){
     links.push(el.href);
     el=el.nextElementSibling;
   }
   if(links.length){
     blocks.push({
       title:text.replace(size?size[0]:"","").trim(),
       size:size?size[0]:"",
       links:links
     });
   }
 });
 return blocks;
}

function renderPost(p){
 const blocks=extractBlocks(p.content.rendered);
 document.title=p.title.rendered+" - filesdl.live";
 headerTitle.textContent=p.title.rendered;
 history.replaceState({},'',"?post="+slugify(p.title.rendered));

 app.innerHTML=`
   <div class="post-title">${p.title.rendered}</div>
   ${blocks.map((b,i)=>`
     <div class="card">
       <h3>${b.title} ${b.size}</h3>

       <a class="btn ${i%2? 'blue':'green'}" href="${b.links[0]}" target="_blank">
         GDFLIX DOWNLOAD
         <div class="size">${b.size}</div>
       </a>

       ${b.links[1]?`
       <a class="btn ${i%2? 'red':'gold'}" href="${b.links[1]}" target="_blank">
         DIRECT DOWNLOAD
         <div class="size">${b.size}</div>
       </a>`:""}
     </div>
   `).join("")}
 `;
}

fetch(API)
.then(r=>r.json())
.then(posts=>{
 const slug=qs("post");
 if(slug){
   const post=posts.find(p=>slugify(p.title.rendered)===slug);
   if(post){renderPost(post);return;}
 }
 app.innerHTML="<p>No post found</p>";
})
.catch(()=>{app.innerHTML="<p>Failed to load</p>"});
</script>

</body>
</html>
