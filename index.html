<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>filesdl.live</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui;background:#0a0a0a;color:#fff}
header{position:sticky;top:0;background:#000;padding:14px 16px;font-weight:800;font-size:18px}
.container{padding:16px;max-width:900px;margin:auto}
.post-title{font-size:22px;font-weight:800;margin-bottom:12px}
.post-content{line-height:1.8;color:#ddd}
.downloads{margin-top:20px;display:grid;gap:10px}
.download-btn{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-radius:8px;background:#141414;color:#fff;text-decoration:none;font-weight:600}
.download-btn span{font-size:13px;color:#aaa}
.posts-list{display:grid;gap:12px}
.post-link{display:block;padding:12px;border-radius:8px;background:#141414;color:#fff;text-decoration:none}
.post-link:hover{background:#1e1e1e}
.skeleton{background:linear-gradient(90deg,#1a1a1a 25%,#2a2a2a 50%,#1a1a1a 75%);background-size:200% 100%;animation:shimmer 1.4s infinite;border-radius:8px;height:60px}
@keyframes shimmer{to{background-position:-200% 0}}
</style>
</head>
<body>

<header>filesdl.live</header>

<div class="container" id="app">
  <div class="skeleton"></div>
  <div class="skeleton"></div>
</div>

<script>
const API="https://filesdl.live/wp-json/wp/v2/posts?_embed&per_page=10";
const app=document.getElementById("app");

function qs(name){return new URLSearchParams(location.search).get(name)}

function parseDownloads(html){
  const div=document.createElement("div");
  div.innerHTML=html;
  const links=[...div.querySelectorAll("a")];
  return links.map(a=>{
    const text=a.textContent.trim();
    const sizeMatch=text.match(/\(([^)]+)\)/);
    return{
      url:a.href,
      title:sizeMatch?text.replace(sizeMatch[0],"").trim():text,
      size:sizeMatch?sizeMatch[1]:""
    }
  });
}

function renderList(posts){
  app.innerHTML='<div class="posts-list"></div>';
  const list=app.firstChild;
  posts.forEach(p=>{
    const a=document.createElement("a");
    a.className="post-link";
    a.href="?post="+p.slug;
    a.textContent=p.title.rendered;
    list.appendChild(a);
  });
}

function renderPost(p){
  const downloads=parseDownloads(p.content.rendered);
  app.innerHTML=`
    <div class="post-title">${p.title.rendered}</div>
    <div class="post-content">${p.content.rendered}</div>
    <div class="downloads">
      ${downloads.map(d=>`
        <a class="download-btn" href="${d.url}" target="_blank">
          <div>${d.title}</div>
          <span>${d.size}</span>
        </a>`).join("")}
    </div>
  `;
}

fetch(API).then(r=>r.json()).then(posts=>{
  const slug=qs("post");
  if(slug){
    const post=posts.find(p=>p.slug===slug);
    if(post){renderPost(post);return;}
  }
  renderList(posts);
}).catch(()=>{
  app.innerHTML="<p>Failed to load data</p>";
});
</script>

</body>
</html>
